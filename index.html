<!doctype html>
<html lang="ru">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <meta name="color-scheme" content="dark" />
    <title>–î–ª—è —Ç–µ–±—è</title>

    <!-- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ-–∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π "–∫–æ–¥–æ–≤—ã–π" —à—Ä–∏—Ñ—Ç (CDN, –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–æ–∫). –ú–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π monospace. -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg: #050608;
            --fg: #e9e9ee;
            --muted: rgba(233, 233, 238, .62);
            --line: rgba(233, 233, 238, .18);
            --line2: rgba(233, 233, 238, .28);
            --pad: max(18px, env(safe-area-inset-top)) max(16px, env(safe-area-inset-right)) max(18px, env(safe-area-inset-bottom)) max(16px, env(safe-area-inset-left));
            --maxw: 42rem;
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            background: var(--bg);
            color: var(--fg);
            font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
            overflow: hidden;
            /* —á—Ç–æ–±—ã –Ω–µ–ª—å–∑—è –±—ã–ª–æ ‚Äú–ª–∏—Å—Ç–∞–Ω—É—Ç—å‚Äù */
        }

        /* Fullscreen —Å—Ü–µ–Ω–∞ */
        .stage {
            position: fixed;
            inset: 0;
            padding: var(--pad);
            display: grid;
            place-items: center;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç-–∫–æ–ª–æ–Ω–∫–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
        .panel {
            width: min(var(--maxw), 100%);
            display: flex;
            flex-direction: column;
            gap: 16px;
            align-items: stretch;
        }

        .topline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            color: var(--muted);
            font-size: 12px;
            letter-spacing: .04em;
        }

        .counter {
            border: 1px solid var(--line);
            padding: 6px 10px;
            border-radius: 0;
            /* –∫–≤–∞–¥—Ä–∞—Ç */
            line-height: 1;
            white-space: nowrap;
        }

        .hint {
            opacity: .9;
            white-space: nowrap;
        }

        /* ‚Äú–¢–µ—Ä–º–∏–Ω–∞–ª‚Äù –±–µ–∑ —Ä–∞–º–æ–∫ (–∫–∞–∫ —Ç—ã –ø—Ä–æ—Å–∏–ª ‚Äî —á–∏—Å—Ç—ã–π —ç–∫—Ä–∞–Ω), –Ω–æ —Å –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º */
        .content {
            min-height: 52svh;
            /* —Å—Ç–∞–±–∏–ª—å–Ω–æ –Ω–∞ –º–æ–±–∏–ª–µ */
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 14px;
            padding: 0;
            border: none;
        }

        .typed {
            font-size: clamp(16px, 2.5vw, 20px);
            line-height: 1.6;
            letter-spacing: 0.01em;
            white-space: pre-wrap;
            word-break: break-word;
        }

        .cursor {
            display: inline-block;
            width: 9px;
            height: 1.2em;
            margin-left: 2px;
            border-left: 1px solid var(--fg);
            transform: translateY(2px);
            animation: blink 1s steps(1) infinite;
            opacity: .85;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }

        .media {
            width: 100%;
            border: 1px solid var(--line);
            border-radius: 0;
            overflow: hidden;
            background: rgba(255, 255, 255, .02);
        }

        .media img {
            display: block;
            width: 100%;
            height: auto;
            max-height: 52svh;
            object-fit: cover;
            filter: contrast(1.02);
        }

        .caption {
            padding: 10px 12px;
            border-top: 1px solid var(--line);
            color: var(--muted);
            font-size: 12px;
            line-height: 1.5;
        }

        .actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            margin-top: 4px;
        }

        .btn {
            appearance: none;
            border: 1px solid var(--line2);
            background: transparent;
            color: var(--fg);
            padding: 12px 14px;
            border-radius: 0;
            /* –∫–≤–∞–¥—Ä–∞—Ç */
            font: inherit;
            letter-spacing: .02em;
            cursor: pointer;
            transition: transform .08s ease, border-color .15s ease, background .15s ease, opacity .15s ease;
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn:hover {
            border-color: rgba(233, 233, 238, .45);
            background: rgba(255, 255, 255, .03);
        }

        .btn.secondary {
            border-color: var(--line);
            color: var(--muted);
        }

        .btn[disabled] {
            opacity: .35;
            cursor: not-allowed;
        }

        /* –ù–µ–≤–∏–¥–∏–º—ã–µ –∑–æ–Ω—ã –¥–ª—è —Ç–∞–ø-–Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (–±–µ–∑ –ª–∏—à–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π) */
        .tapzones {
            position: fixed;
            inset: 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            opacity: 0;
            pointer-events: none;
            /* –≤–∫–ª—é—á–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ */
        }

        .tapzones.enabled {
            pointer-events: auto;
        }

        .tapzone {}

        /* –ú—è–≥–∫–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–ª–∞–π–¥–æ–≤ */
        .fade {
            animation: fadeIn .22s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(4px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* –£–≤–∞–∂–µ–Ω–∏–µ –∫ —Ç–µ–º, –∫—Ç–æ –Ω–µ –ª—é–±–∏—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ */
        @media (prefers-reduced-motion: reduce) {
            .cursor {
                animation: none;
                opacity: 0;
            }

            .fade {
                animation: none;
            }

            .btn {
                transition: none;
            }
        }
    </style>
</head>

<body>
    <main class="stage" id="stage">
        <div class="panel">
            <div class="topline">
                <div class="hint" id="hint">—Ç–∞–ø–Ω–∏ —Å–ø—Ä–∞–≤–∞ ‚Äî –¥–∞–ª—å—à–µ ‚Ä¢ —Å–ª–µ–≤–∞ ‚Äî –Ω–∞–∑–∞–¥</div>
                <div class="counter" id="counter">00/00</div>
            </div>

            <section class="content" id="content">
                <div class="typed" id="typed"></div>
            </section>

            <div class="actions">
                <button class="btn secondary" id="backBtn" disabled>–Ω–∞–∑–∞–¥</button>
                <button class="btn" id="nextBtn" disabled>–Ω–∞—á–∞—Ç—å</button>
            </div>
        </div>
    </main>

    <!-- –ù–µ–≤–∏–¥–∏–º—ã–µ –∑–æ–Ω—ã: –ª–µ–≤–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ —ç–∫—Ä–∞–Ω–∞ = –Ω–∞–∑–∞–¥, –ø—Ä–∞–≤–∞—è = –¥–∞–ª—å—à–µ -->
    <div class="tapzones" id="tapzones" aria-hidden="true">
        <div class="tapzone" id="tapLeft"></div>
        <div class="tapzone" id="tapRight"></div>
    </div>

    <script>
        // ====== –ù–ê–°–¢–†–û–ô–ö–ò –°–õ–ê–ô–î–û–í ======
        // type: "text" | "image"
        // –î–ª—è image: src = –ø—É—Ç—å –∫ –∫–∞—Ä—Ç–∏–Ω–∫–µ (–ª—É—á—à–µ –ø–æ–ª–æ–∂–∏—Ç—å –≤ –ø–∞–ø–∫—É /assets/)
        const slides = [
            {
                type: "text",
                // –í–°–¢–£–ü: –ø–µ—á–∞—Ç–∞–µ—Ç—Å—è ‚Äú–∫–∞–∫ –∫–æ–¥‚Äù
                text:
                    `[system] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è‚Ä¶
[time] 31.12 ‚Üí 01.01

‚Ä¶–ø—Ä–∏–≤–µ—Ç.

–ù–æ–≤—ã–π –≥–æ–¥ ‚Äî —ç—Ç–æ –ø–æ–≤–æ–¥ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –º–∏–Ω—É—Ç—É.
–¢—ã –≥–æ—Ç–æ–≤–∞ –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–∞—Ä–æ–∫?`
            },
            {
                type: "text",
                text:
                    `–ï—Å–ª–∏ –∫–æ—Ä–æ—Ç–∫–æ:
—è –æ—á–µ–Ω—å —Ç–µ–±—è –ª—é–±–ª—é.

–ï—Å–ª–∏ —á–µ—Å—Ç–Ω–æ:
—è –ª—é–±–ª—é —Ç–µ–±—è —Ç–∞–∫, —á—Ç–æ —ç—Ç–æ –∏–Ω–æ–≥–¥–∞ –¥–∞–∂–µ –ø—É–≥–∞–µ—Ç ‚Äî –≤ —Ö–æ—Ä–æ—à–µ–º —Å–º—ã—Å–ª–µ.`
            },
            {
                type: "image",
                src: "assets/01_first_chat.jpg",
                caption: "–ù–∞—à–µ –ø–µ—Ä–≤–æ–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ. –¢–æ—á–∫–∞, —Å –∫–æ—Ç–æ—Ä–æ–π –≤—Å—ë –ø–æ–µ—Ö–∞–ª–æ :)"
            },
            {
                type: "image",
                src: "assets/02_lf_dialog.jpg",
                caption: "–ü–µ—Ä–≤—ã–π –¥–∏–∞–ª–æ–≥ –≤ –õ–°. –Ø –¥–æ —Å–∏—Ö —É–º–∏–ª—è—é—Å—å —Å –Ω–∞—Å."
            },
            {
                type: "image",
                src: "assets/03_avatars.jpg",
                caption: "–≠—Ç–æ –º—ã —Å —Ç–æ–±–æ–π –∫—Å—Ç–∞—Ç–∏, –≤–µ—Ä–∏—à—å?"
            },
            {
                type: "image",
                src: "assets/04_game.jpg",
                caption: "–°—á–∞—Å—Ç–ª–∏–≤–∞—è —Å–µ–º—å—è: –¢—ã, —è –∏ –∂–µ—Å—Ç—è–Ω–æ—á–∫–∞"
            },
            {
                type: "text",
                text:
                    `–Ø —Å–æ–±—Ä–∞–ª —ç—Ç–æ –∫–∞–∫ –º–∞–ª–µ–Ω—å–∫–∏–π –∞—Ä—Ö–∏–≤.
–ù–µ —á—Ç–æ–±—ã ‚Äú–≤—Å–ø–æ–º–Ω–∏—Ç—å –ø—Ä–æ—à–ª–æ–µ‚Äù,
–∞ —á—Ç–æ–±—ã –µ—â—ë —Ä–∞–∑ –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å: –º—ã ‚Äî —Ä–µ–∞–ª—å–Ω—ã.

–û—Ç–∫—Ä–æ–π –ø–∏—Å—å–º–æ –≤ –∫–æ—Ä–æ–±–∫–µ.
–¢–∞–º ‚Äî —Ç–æ, —á—Ç–æ —è –Ω–µ —Ö–æ—á—É —Ç–µ—Ä—è—Ç—å.`
            },
            {
                type: "text",
                text:
                    `–ö–æ–Ω–µ—Ü ‚Äî —ç—Ç–æ –Ω–µ –∫–æ–Ω–µ—Ü.

–ü—Ä–æ—Å—Ç–æ‚Ä¶
—Å –ù–æ–≤—ã–º –≥–æ–¥–æ–º, –ª—é–±–∏–º–∞—è.

[ok]`
            }
        ];

        // ====== –õ–û–ì–ò–ö–ê ======
        const typedEl = document.getElementById('typed');
        const contentEl = document.getElementById('content');
        const nextBtn = document.getElementById('nextBtn');
        const backBtn = document.getElementById('backBtn');
        const counterEl = document.getElementById('counter');
        const hintEl = document.getElementById('hint');

        const tapzones = document.getElementById('tapzones');
        const tapLeft = document.getElementById('tapLeft');
        const tapRight = document.getElementById('tapRight');

        let idx = 0;
        let typing = false;
        let typedDoneOnce = false;

        const total = slides.length;

        function setCounter() {
            const a = String(idx + 1).padStart(2, '0');
            const b = String(total).padStart(2, '0');
            counterEl.textContent = `${a}/${b}`;
        }

        function clearContent() {
            contentEl.innerHTML = `<div class="typed" id="typed"></div>`;
            // –æ–±–Ω–æ–≤–∏–º —Å—Å—ã–ª–∫—É –Ω–∞ typed
            const t = document.getElementById('typed');
            return t;
        }

        function typeText(el, text, speed = 18) {
            return new Promise((resolve) => {
                typing = true;
                nextBtn.disabled = true;
                backBtn.disabled = (idx === 0);

                el.textContent = "";
                const cursor = document.createElement('span');
                cursor.className = 'cursor';
                el.appendChild(cursor);

                let i = 0;
                const reduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                const effectiveSpeed = reduced ? 0 : speed;

                function tick() {
                    if (i < text.length) {
                        // –≤—Å—Ç–∞–≤–ª—è–µ–º —Å–∏–º–≤–æ–ª –ø–µ—Ä–µ–¥ –∫—É—Ä—Å–æ—Ä–æ–º
                        cursor.insertAdjacentText('beforebegin', text[i]);
                        i++;
                        if (effectiveSpeed === 0) {
                            // –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
                            continueTick();
                        } else {
                            setTimeout(tick, effectiveSpeed);
                        }
                    } else {
                        // —É–±–µ—Ä—ë–º –∫—É—Ä—Å–æ—Ä (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å ‚Äî –Ω–æ —Ç–∞–∫ —á–∏—â–µ)
                        cursor.remove();
                        typing = false;
                        nextBtn.disabled = false;
                        backBtn.disabled = (idx === 0);
                        resolve();
                    }
                }

                function continueTick() {
                    // –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏ —Ç–∞–π–º–µ—Ä–æ–≤
                    while (i < text.length) {
                        cursor.insertAdjacentText('beforebegin', text[i]);
                        i++;
                    }
                    cursor.remove();
                    typing = false;
                    nextBtn.disabled = false;
                    backBtn.disabled = (idx === 0);
                    resolve();
                }

                tick();
            });
        }

        function renderSlide(n) {
            idx = Math.max(0, Math.min(total - 1, n));
            setCounter();

            // –∫–Ω–æ–ø–∫–∏
            backBtn.disabled = (idx === 0);
            nextBtn.textContent = (idx === 0 && !typedDoneOnce) ? "–Ω–∞—á–∞—Ç—å" : "–¥–∞–ª—å—à–µ";

            // –∫–æ–Ω—Ç–µ–Ω—Ç
            contentEl.classList.remove('fade');
            void contentEl.offsetWidth; // reflow –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
            contentEl.classList.add('fade');

            const slide = slides[idx];

            // —Ç–∞–ø-–∑–æ–Ω—ã –≤–∫–ª—é—á–∞–µ–º –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ (—á—Ç–æ–±—ã ‚Äú–Ω–∞—á–∞—Ç—å‚Äù –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–æ —Å–ª—É—á–∞–π–Ω–æ)
            tapzones.classList.toggle('enabled', idx > 0);

            if (slide.type === "image") {
                hintEl.textContent = "—Ç–∞–ø–Ω–∏ —Å–ø—Ä–∞–≤–∞ ‚Äî –¥–∞–ª—å—à–µ ‚Ä¢ —Å–ª–µ–≤–∞ ‚Äî –Ω–∞–∑–∞–¥";
                nextBtn.disabled = false;

                contentEl.innerHTML = `
          <div class="media">
            <img src="${slide.src}" alt="">
            ${slide.caption ? `<div class="caption">${escapeHtml(slide.caption)}</div>` : ""}
          </div>
        `;
            } else {
                hintEl.textContent = (idx === 0) ? "–ø–æ—Å–ª–µ –ø–µ—á–∞—Ç–∏ –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞" : "—Ç–∞–ø–Ω–∏ —Å–ø—Ä–∞–≤–∞ ‚Äî –¥–∞–ª—å—à–µ ‚Ä¢ —Å–ª–µ–≤–∞ ‚Äî –Ω–∞–∑–∞–¥";

                const newTypedEl = clearContent();
                const text = slide.text || "";

                // –ù–∞ –ø–µ—Ä–≤–æ–º —ç–∫—Ä–∞–Ω–µ ‚Äî –ø–µ—á–∞—Ç—å –≤—Å–µ–≥–¥–∞ (—É–ª—å—Ç–∏–º–∞—Ç–∏–≤–Ω—ã–π ‚Äú—ç—Ñ—Ñ–µ–∫—Ç —Å—Ç–∞—Ä—Ç–∞‚Äù)
                // –ù–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö ‚Äî —Ç–æ–∂–µ –ø–µ—á–∞—Ç—å, –Ω–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ: –ø—Ä–æ—Å—Ç–æ –ø–æ—Å—Ç–∞–≤—å speed=0
                const speed = (idx === 0) ? 16 : 10;

                typeText(newTypedEl, text, speed).then(() => {
                    if (idx === 0) {
                        typedDoneOnce = true;
                        nextBtn.textContent = "–Ω–∞—á–∞—Ç—å";
                    }
                    else if (idx === total - 1) {
                        nextBtn.textContent = "–µ—â—ë —Ä–∞–∑";

                        // üëá –î–û–ë–ê–í–õ–Ø–ï–ú –ö–ù–û–ü–ö–£ –ü–ï–†–ï–•–û–î–ê
                        const linkBtn = document.createElement('a');
                        linkBtn.href = 'newyear.html';
                        linkBtn.className = 'btn';
                        linkBtn.style.marginTop = '24px';
                        linkBtn.textContent = '–ø–µ—Ä–µ–π—Ç–∏ –¥–∞–ª—å—à–µ';

                        contentEl.appendChild(linkBtn);
                    }
                    else {
                        nextBtn.textContent = "–¥–∞–ª—å—à–µ";
                    }
                });

            }
        }

        function goNext() {
            if (typing) return; // –≤–æ –≤—Ä–µ–º—è –ø–µ—á–∞—Ç–∏ –Ω–µ –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–µ–º
            if (idx === total - 1) {
                // –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤ –Ω–∞—á–∞–ª–æ
                typedDoneOnce = true;
                renderSlide(0);
                return;
            }
            renderSlide(idx + 1);
        }

        function goBack() {
            if (typing) return;
            renderSlide(idx - 1);
        }

        function escapeHtml(str) {
            return String(str)
                .replaceAll('&', '&amp;')
                .replaceAll('<', '&lt;')
                .replaceAll('>', '&gt;')
                .replaceAll('"', '&quot;')
                .replaceAll("'", "&#039;");
        }

        // –ö–Ω–æ–ø–∫–∏
        nextBtn.addEventListener('click', goNext);
        backBtn.addEventListener('click', goBack);

        // –¢–∞–ø-–∑–æ–Ω—ã
        tapRight.addEventListener('click', goNext);
        tapLeft.addEventListener('click', goBack);

        // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (–¥–µ—Å–∫—Ç–æ–ø)
        window.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === 'Enter' || e.key === ' ') goNext();
            if (e.key === 'ArrowLeft') goBack();
        }, { passive: true });

        // –°—Ç–∞—Ä—Ç
        setCounter();
        // –ù–∞ –ø–µ—Ä–≤–æ–º —ç–∫—Ä–∞–Ω–µ –∫–Ω–æ–ø–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –ø–æ–∫–∞ –ø–µ—á–∞—Ç–∞–µ—Ç
        backBtn.disabled = true;
        nextBtn.disabled = true;
        renderSlide(0);
    </script>
</body>

</html>